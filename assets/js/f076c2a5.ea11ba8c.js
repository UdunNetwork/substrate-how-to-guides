(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{187:function(e,t,n){"use strict";n.r(t),n.d(t,"MDXContext",(function(){return d})),n.d(t,"MDXProvider",(function(){return m})),n.d(t,"mdx",(function(){return b})),n.d(t,"useMDXComponents",(function(){return p})),n.d(t,"withMDXComponents",(function(){return l}));var r=n(0),i=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var d=i.a.createContext({}),l=function(e){return function(t){var n=p(t.components);return i.a.createElement(e,a({},t,{components:n}))}},p=function(e){var t=i.a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},m=function(e){var t=p(e.components);return i.a.createElement(d.Provider,{value:t},e.children)},g={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},h=i.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,a=e.parentName,s=u(e,["components","mdxType","originalType","parentName"]),d=p(n),l=r,m=d["".concat(a,".").concat(l)]||d[l]||g[l]||o;return n?i.a.createElement(m,c(c({ref:t},s),{},{components:n})):i.a.createElement(m,c({ref:t},s))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,a[1]=s;for(var u=2;u<o;u++)a[u]=n[u];return i.a.createElement.apply(null,a)}return i.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},85:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return d}));var r=n(3),i=n(8),o=(n(0),n(187)),a={sidebar_position:9},s={unversionedId:"pallet-design/custom-origins",id:"pallet-design/custom-origins",isDocsHomePage:!1,title:"How to create and use a custom origin",description:"The guide's intentions should be clear by just reading the title.",source:"@site/docs/02-pallet-design/custom-origins.md",sourceDirName:"02-pallet-design",slug:"/pallet-design/custom-origins",permalink:"/substrate-how-to-guides/docs/pallet-design/custom-origins",editUrl:"https://github.com/substrate-developer-hub/substrate-how-to-guides/edit/main/docs/02-pallet-design/custom-origins.md",version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"Create and use a storage Map",permalink:"/substrate-how-to-guides/docs/pallet-design/storage-map"},next:{title:"Conditional weighting struct",permalink:"/substrate-how-to-guides/docs/weights/conditional-weight-struct"}},c=[{value:"Goal",id:"goal",children:[]},{value:"Use cases",id:"use-cases",children:[]},{value:"Overview",id:"overview",children:[]},{value:"Steps",id:"steps",children:[{value:"1. Add an Orgin type to your pallet&#39;s <code>Config</code> trait",id:"1-add-an-orgin-type-to-your-pallets-config-trait",children:[]},{value:"2. Create a custom enum of type Origin",id:"2-create-a-custom-enum-of-type-origin",children:[]},{value:"3. Create a struct and implement <code>try_origin</code> on it",id:"3-create-a-struct-and-implement-try_origin-on-it",children:[]},{value:"4. Ensure orgin in dispatchable",id:"4-ensure-orgin-in-dispatchable",children:[]},{value:"5. Use this origin in another pallet",id:"5-use-this-origin-in-another-pallet",children:[]},{value:"6. Define the origins inside <code>runtime/src/lib.rs</code>",id:"6-define-the-origins-inside-runtimesrclibrs",children:[]}]},{value:"Examples",id:"examples",children:[]},{value:"Resources",id:"resources",children:[]}],u={toc:c};function d(e){var t=e.components,n=Object(i.default)(e,["components"]);return Object(o.mdx)("wrapper",Object(r.default)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(o.mdx)("p",null,Object(o.mdx)("em",{parentName:"p"},"The guide's intentions should be clear by just reading the title.")),Object(o.mdx)("h2",{id:"goal"},"Goal"),Object(o.mdx)("p",null,"Define and use a custom origin."),Object(o.mdx)("h2",{id:"use-cases"},"Use cases"),Object(o.mdx)("p",null,Object(o.mdx)("em",{parentName:"p"},'What practical use cases can this guide be applied to? This can be general, e.g. "implementing a second currency for users to pay fees in" or specific, for e.g. "a runtime migration from a ',Object(o.mdx)("inlineCode",{parentName:"em"},"Vec<u32>"),' to SomeStruct ". It is likely that the more advanced the guide, the more specific its use cases will be. If more than one, bullet list. Otherwise, one phrase.')),Object(o.mdx)("h2",{id:"overview"},"Overview"),Object(o.mdx)("p",null,Object(o.mdx)("em",{parentName:"p"},"A brief overview of why this is a useful guide and what concepts it uses. This is a good place to link to other devhub ressources, including other guides, aiming to give the reader the learning background required to understand how this guide can be useful to them.")),Object(o.mdx)("h2",{id:"steps"},"Steps"),Object(o.mdx)("h3",{id:"1-add-an-orgin-type-to-your-pallets-config-trait"},"1. Add an Orgin type to your pallet's ",Object(o.mdx)("inlineCode",{parentName:"h3"},"Config")," trait"),Object(o.mdx)("pre",null,Object(o.mdx)("code",{parentName:"pre",className:"language-rust"},"pub trait Config: frame_system::Config {\n    type Origin: From<Origin>;\n}\n")),Object(o.mdx)("h3",{id:"2-create-a-custom-enum-of-type-origin"},"2. Create a custom enum of type Origin"),Object(o.mdx)("pre",null,Object(o.mdx)("code",{parentName:"pre",className:"language-rust"},"#[derive(PartialEq, Eq, Clone, sp_runtime::RuntimeDebug, codec::Encode, codec::Decode)]\npub enum Origin {\n    Dumbo,\n}\n")),Object(o.mdx)("h3",{id:"3-create-a-struct-and-implement-try_origin-on-it"},"3. Create a struct and implement ",Object(o.mdx)("inlineCode",{parentName:"h3"},"try_origin")," on it"),Object(o.mdx)("pre",null,Object(o.mdx)("code",{parentName:"pre",className:"language-rust"},"/// Helper that other pallets may use to check that a dispatch is from Dumbo.\npub struct EnsureDumbo;\nimpl<\n    O: Into<Result<Origin, O>> + From<Origin>> frame_support::traits::EnsureOrigin<O> for EnsureDumbo {\n    type Success = ();\n    fn try_origin(o: O) -> Result<Self::Success, O> {\n        o.into().and_then(|o| match o {\n            Origin::Dumbo => Ok(()),\n        })\n    }\n}\n")),Object(o.mdx)("h3",{id:"4-ensure-orgin-in-dispatchable"},"4. Ensure orgin in dispatchable"),Object(o.mdx)("pre",null,Object(o.mdx)("code",{parentName:"pre",className:"language-rust"},"pub fn proxy_dumbo(origin, call: Box<<T as Trait>::Call>) -> dispatch::DispatchResult {\n            let who = ensure_signed(origin)?;\n            frame_support::ensure!(who == T::DumboAccountId::get(), sp_runtime::DispatchError::BadOrigin);\n            let res = call.dispatch(Origin::Dumbo.into());\n            Self::deposit_event(Event::Dumdid(res.map(|_| ()).map_err(|e| e.error)));\n            Ok(())\n        }\n")),Object(o.mdx)("h3",{id:"5-use-this-origin-in-another-pallet"},"5. Use this origin in another pallet"),Object(o.mdx)("h4",{id:"i-config-trait"},"i. Config trait"),Object(o.mdx)("pre",null,Object(o.mdx)("code",{parentName:"pre",className:"language-rust"},"pub trait Config: frame_system::Config {\n    type DumboOrigin: frame_support::traits::EnsureOrigin<Self::Origin>;\n}\n")),Object(o.mdx)("h4",{id:"ii-inside-a-dispatchable"},"ii. Inside a dispatchable"),Object(o.mdx)("pre",null,Object(o.mdx)("code",{parentName:"pre",className:"language-rust"},"pub fn dumbo_wants_peanuts(origin) -> dispatch::DispatchResult {\n            T::DumboOrigin::ensure_origin(origin)?;\n            Self::deposit_event(Event::DumboWantsPeanuts);\n            Ok(())\n        }\n")),Object(o.mdx)("h3",{id:"6-define-the-origins-inside-runtimesrclibrs"},"6. Define the origins inside ",Object(o.mdx)("inlineCode",{parentName:"h3"},"runtime/src/lib.rs")),Object(o.mdx)("p",null,"--"),Object(o.mdx)("p",null,Object(o.mdx)("em",{parentName:"p"},"What are the steps that will be taken to achieve the goal? Each step should be action driven, with little description, minimal fluff,\nlinking to other docs if needed. Code snippets can help illustrate the steps but should not take over the focus","\u2014",'i.e "how do I do this", not "what do I do".')),Object(o.mdx)("h2",{id:"examples"},"Examples"),Object(o.mdx)("p",null,Object(o.mdx)("em",{parentName:"p"},"Code-based examples that make use of this guide. This shows at least one reference of what this guide covers with a working example.This could be a reference to a Playground codebase instance, existing Substrate code or custom code that lives in the how-to guide repo.")),Object(o.mdx)("h2",{id:"resources"},"Resources"),Object(o.mdx)("p",null,Object(o.mdx)("em",{parentName:"p"},"A bulleted list of links to similar guides; other devhub ressources; and related material. See options below.")))}d.isMDXComponent=!0}}]);